#!/usr/bin/env bash
# ****************************************************
#
#   MVCSS Find Used Tools
#   -> Find and display used tool classes
#
# ----------------------------------------------------
#   Usage
# ----------------------------------------------------
#
#  `mvcss-find-used-tools`
#
# ****************************************************

set -o errexit
set -o nounset
set -o pipefail

# ----------------------------------------------------
#   Variables
# ----------------------------------------------------

BACKGROUND_TOOLS=('bch' 'bci' 'bcs')
DISPLAY_TOOLS=('db' 'di' 'dib' 'dn')
MARGIN_TOOLS=('maf' 'maxs' 'mas' 'mam' 'mal' 'maxl' 'mtf' 'mtxs' 'mts' 'mtm' 'mtl' 'mtxl' 'mrf' 'mrxs' 'mrs' 'mrm' 'mrl' 'mrxl' 'mbf' 'mbxs' 'mbs' 'mbm' 'mbl' 'mbxl' 'mlf' 'mlxs' 'mls' 'mlm' 'mll' 'mlxl' 'mhc')
PADDING_TOOLS=('paf' 'paxs' 'pas' 'pam' 'pal' 'paxl' 'ptf' 'ptxs' 'pts' 'ptm' 'ptl' 'ptxl' 'prf' 'prxs' 'prs' 'prm' 'prl' 'prxl' 'pbf' 'pbxs' 'pbs' 'pbm' 'pbl' 'pbxl' 'plf' 'plxs' 'pls' 'plm' 'pll' 'plxl')
POSITION_TOOLS=('fl' 'fr' 'poa' 'pof' 'por' 'pos')
ROUNDING_TOOLS=('ra' 'ram' 'ran')
TEXT_TOOLS=('tac' 'tal' 'tar' 'tch' 'tci' 'tcs' 'tct' 'tfb' 'tfh' 'tsxs' 'tss' 'tsl' 'tsxl' 'tsi' 'ttu' 'twn' 'twb')

# ----------------------------------------------------
#   Functions
# ----------------------------------------------------

function find_match() {
  local sizes=('s' 'm' 'l')
  local regular_match=$(ag --haml "$1")

  if [ ! -z "$regular_match" -a "$regular_match" != "" ]; then
    echo "  ==> '.$1' is used"
  fi

  for rm in "${sizes[@]}"; do
    local responsive_match=$(ag --haml "$1--$rm")

    if [ ! -z "$responsive_match" -a "$responsive_match" != "" ]; then
      echo "  ==> '.$1--$rm' is used"
    fi
  done
}

# ----------------------------------------------------
#   Main
# ----------------------------------------------------

# ----- Background ----- #

for bt in "${BACKGROUND_TOOLS[@]}"; do
  find_match $bt
done

# ----- Display ----- #

for dt in "${DISPLAY_TOOLS[@]}"; do
  find_match $dt
done

# ----- Margin ----- #

for mt in "${MARGIN_TOOLS[@]}"; do
  find_match $mt
done

# ----- Padding ----- #

for pt in "${PADDING_TOOLS[@]}"; do
  find_match $pt
done

# ----- Position ----- #

for pst in "${POSITION_TOOLS[@]}"; do
  find_match $pst
done

# ----- Rounding ----- #

for rt in "${ROUNDING_TOOLS[@]}"; do
  find_match $rt
done

# ----- Text ----- #

for tt in "${TEXT_TOOLS[@]}"; do
  find_match $tt
done
